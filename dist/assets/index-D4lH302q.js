var ye=Object.defineProperty,ve=Object.defineProperties;var be=Object.getOwnPropertyDescriptors;var oe=Object.getOwnPropertySymbols;var Me=Object.prototype.hasOwnProperty,He=Object.prototype.propertyIsEnumerable;var ne=(n,r,s)=>r in n?ye(n,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[r]=s,k=(n,r)=>{for(var s in r||(r={}))Me.call(r,s)&&ne(n,s,r[s]);if(oe)for(var s of oe(r))He.call(r,s)&&ne(n,s,r[s]);return n},E=(n,r)=>ve(n,be(r));var A=(n,r,s)=>new Promise((i,c)=>{var a=d=>{try{t(s.next(d))}catch(u){c(u)}},e=d=>{try{t(s.throw(d))}catch(u){c(u)}},t=d=>d.done?i(d.value):Promise.resolve(d.value).then(a,e);t((s=s.apply(n,r)).next())});import{i as ce,W as Ce,B as Se,T as ke,t as Be,Y as Fe,S as Oe,h as ue,I as we,d as Te,s as Pe,J as de,x as $e,w as Ne}from"./entry/index-DeA-E56H-1712476170604.js";import{h as Y,u as o,d as _,I as De,k as B,i as Re,f as g,c as F,w as pe,o as _e,b as fe,y as $,n as We,Z as M,a8 as D,a9 as h,m as xe,_ as V,ae as N,ag as je,F as Ee,ab as U,a1 as Ie,a7 as Le,G,a0 as K,ac as I,K as Ae,g as Q,z as ze,ad as ae,aa as le,aj as se,ak as re,r as me,J as z}from"./vue-BsEqlI2B.js";import{M as qe,av as Ve,T as J,aw as Ye,ax as Xe,o as q,e as ge,a as Je}from"./antd-DeDWztM9.js";import{u as Ue}from"./useWindowSizeFn-dzDjg1EY.js";const{t:ie}=ce(),Ge={open:{type:Boolean},scrollTop:{type:Boolean,default:!0},height:{type:Number},minHeight:{type:Number},draggable:{type:Boolean,default:!0},centered:{type:Boolean},cancelText:{type:String,default:ie("common.cancelText")},okText:{type:String,default:ie("common.okText")},closeFunc:Function},ee=Object.assign({},Ge,{defaultFullscreen:{type:Boolean},canFullscreen:{type:Boolean,default:!0},wrapperFooterOffset:{type:Number,default:0},helpMessage:[String,Array],useWrapper:{type:Boolean,default:!0},loading:{type:Boolean},loadingTip:{type:String},showCancelBtn:{type:Boolean,default:!0},showOkBtn:{type:Boolean,default:!0},wrapperProps:Object,afterClose:Function,bodyStyle:Object,closable:{type:Boolean,default:!0},closeIcon:Object,confirmLoading:{type:Boolean},destroyOnClose:{type:Boolean},footer:Object,getContainer:Function,mask:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},keyboard:{type:Boolean,default:!0},maskStyle:Object,okType:{type:String,default:"primary"},okButtonProps:Object,cancelButtonProps:Object,title:{type:String},open:{type:Boolean},width:[String,Number],wrapClassName:{type:String},zIndex:{type:Number}});function Ke(n){const r=(c,a)=>getComputedStyle(c)[a],s=c=>{if(!c)return;c.setAttribute("data-drag",o(n.draggable));const a=c.querySelector(".ant-modal-header"),e=c.querySelector(".ant-modal");!a||!e||!o(n.draggable)||(a.style.cursor="move",a.onmousedown=t=>{if(!t)return;const d=t.clientX,u=t.clientY,S=document.body.clientWidth,b=document.documentElement.clientHeight,y=e.offsetWidth,p=e.offsetHeight,f=e.offsetLeft,m=S-e.offsetLeft-y,v=e.offsetTop,O=b-e.offsetTop-p,H=r(e,"left"),C=r(e,"top");let W=+H,x=+C;H.includes("%")?(W=+document.body.clientWidth*(+H.replace(/%/g,"")/100),x=+document.body.clientHeight*(+C.replace(/%/g,"")/100)):(W=+H.replace(/px/g,""),x=+C.replace(/px/g,"")),document.onmousemove=function(L){let T=L.clientX-d,P=L.clientY-u;-T>f?T=-f:T>m&&(T=m),-P>v?P=-v:P>O&&(P=O),e.style.cssText+=`;left:${T+W}px;top:${P+x}px;`},document.onmouseup=()=>{document.onmousemove=null,document.onmouseup=null}})},i=()=>{const c=document.querySelectorAll(".ant-modal-wrap");for(const a of Array.from(c)){if(!a)continue;const e=r(a,"display"),t=a.getAttribute("data-drag");e!=="none"&&(t===null||o(n.destroyOnClose))&&s(a)}};Y(()=>{!o(n.open)||!o(n.draggable)||Ce(()=>{i()},30)})}function Ze(n){return typeof n=="function"||Object.prototype.toString.call(n)==="[object Object]"&&!Re(n)}const Qe=_({name:"Modal",inheritAttrs:!1,props:ee,emits:["cancel"],setup(n,{slots:r,emit:s,attrs:i}){const{open:c,draggable:a,destroyOnClose:e}=De(n);Ke({open:c,destroyOnClose:e,draggable:a});const t=d=>{s("cancel",d)};return()=>{let d;const u=E(k(k({},o(i)),n),{onCancel:t});return B(qe,u,Ze(d=Se(r))?d:{default:()=>[d]})}}}),he=Symbol();function et(n){return Be(n,he)}function ft(){return ke(he)}const tt=["loading-tip"],ot=_({name:"ModalWrapper",inheritAttrs:!1,__name:"ModalWrapper",props:{loading:{type:Boolean},useWrapper:{type:Boolean,default:!0},modalHeaderHeight:{type:Number,default:57},modalFooterHeight:{type:Number,default:74},minHeight:{type:Number,default:200},height:{type:Number},footerOffset:{type:Number,default:0},open:{type:Boolean},fullScreen:{type:Boolean},loadingTip:{type:String}},emits:["height-change","ext-height"],setup(n,{expose:r,emit:s}){const i=n,c=s,a=g(null),e=g(null),t=g(0),d=g(0),u=g(0);Ue(y.bind(null)),Fe(e,()=>{y()},{attributes:!0,subtree:!0}),et({redoModalHeight:y});const S=F(()=>({minHeight:`${i.minHeight}px`,[i.fullScreen?"height":"maxHeight"]:`${o(t)}px`}));Y(()=>{i.useWrapper&&y()}),pe(()=>i.fullScreen,p=>{y(),p?d.value=t.value:t.value=d.value}),_e(()=>{const{modalHeaderHeight:p,modalFooterHeight:f}=i;c("ext-height",p+f)}),fe(()=>{});function b(){return A(this,null,function*(){$(()=>{var f;const p=o(a);p&&((f=p==null?void 0:p.scrollTo)==null||f.call(p,0))})})}function y(){return A(this,null,function*(){if(!i.open)return;const p=o(a);if(!p)return;const f=p.$el.parentElement;if(f){f.style.padding="0",yield $();try{const m=f.parentElement&&f.parentElement.parentElement;if(!m)return;const v=getComputedStyle(m).top,O=Number.parseInt(v);let H=window.innerHeight-O*2+(i.footerOffset||0)-i.modalFooterHeight-i.modalHeaderHeight;O<40&&(H-=26),yield $();const C=o(e);if(!C)return;yield $(),u.value=C.scrollHeight,i.fullScreen?t.value=window.innerHeight-i.modalFooterHeight-i.modalHeaderHeight-28:t.value=i.height?i.height:u.value>H?H:u.value,c("height-change",o(t))}catch(m){}}})}return r({scrollTop:b,setModalHeight:y}),(p,f)=>{const m=We("loading");return M(),D(o(Oe),{ref_key:"wrapperRef",ref:a,scrollHeight:u.value},{default:h(()=>[xe((M(),V("div",{ref_key:"spinRef",ref:e,style:je(S.value),"loading-tip":n.loadingTip},[N(p.$slots,"default")],12,tt)),[[m,n.loading]])]),_:3},8,["scrollHeight"])}}}),nt=_({name:"ModalClose",__name:"ModalClose",props:{canFullscreen:{type:Boolean,default:!0},fullScreen:{type:Boolean}},emits:["cancel","fullscreen"],setup(n,{emit:r}){const s=n,i=r,{prefixCls:c}=ue("basic-modal-close"),{t:a}=ce(),e=F(()=>[c,`${c}--custom`,{[`${c}--can-full`]:s.canFullscreen}]);function t(u){i("cancel",u)}function d(u){u==null||u.stopPropagation(),u==null||u.preventDefault(),i("fullscreen")}return(u,S)=>(M(),V("div",{class:Ie(e.value)},[n.canFullscreen?(M(),V(Ee,{key:0},[n.fullScreen?(M(),D(o(J),{key:0,title:o(a)("component.modal.restore"),placement:"bottom"},{default:h(()=>[B(o(Ve),{role:"full",onClick:d})]),_:1},8,["title"])):(M(),D(o(J),{key:1,title:o(a)("component.modal.maximize"),placement:"bottom"},{default:h(()=>[B(o(Ye),{role:"close",onClick:d})]),_:1},8,["title"]))],64)):U("",!0),B(o(J),{title:o(a)("component.modal.close"),placement:"bottom"},{default:h(()=>[B(o(Xe),{onClick:t})]),_:1},8,["title"])],2))}}),at=_({name:"BasicModalFooter",__name:"ModalFooter",props:ee,emits:["ok","cancel"],setup(n,{emit:r}){const s=r;function i(a){s("ok",a)}function c(a){s("cancel",a)}return(a,e)=>{const t=Le("a-button");return M(),V("div",null,[N(a.$slots,"insertFooter"),a.showCancelBtn?(M(),D(t,I({key:0},a.cancelButtonProps,{onClick:c}),{default:h(()=>[G(K(a.cancelText),1)]),_:1},16)):U("",!0),N(a.$slots,"centerFooter"),a.showOkBtn?(M(),D(t,I({key:1,type:a.okType,onClick:i,loading:a.confirmLoading},a.okButtonProps),{default:h(()=>[G(K(a.okText),1)]),_:1},16,["type","loading"])):U("",!0),N(a.$slots,"appendFooter")])}}}),lt=_({name:"BasicModalHeader",__name:"ModalHeader",props:{helpMessage:{type:[String,Array]},title:{type:String}},setup(n){return(r,s)=>(M(),D(o(we),{helpMessage:n.helpMessage},{default:h(()=>[G(K(n.title),1)]),_:1},8,["helpMessage"]))}});function st(n){const r=g(!1),s=F(()=>{const c=o(n.wrapClassName)||"";return o(r)?`fullscreen-modal ${c} `:o(c)});function i(c){c&&c.stopPropagation(),r.value=!o(r)}return{getWrapClassName:s,handleFullScreen:i,fullScreenRef:r}}const rt=_({name:"BasicModal",inheritAttrs:!1,__name:"BasicModal",props:ee,emits:["open-change","height-change","cancel","ok","register","update:open","fullscreen"],setup(n,{emit:r}){const s=n,i=r,c=Ae(),a=g(!1),e=g(null),t=g(null),{prefixCls:d}=ue("basic-modal"),u=g(0),S={setModalProps:W,emitOpen:void 0,redoModalHeight:()=>{$(()=>{o(t)&&o(t).setModalHeight()})}},b=Q();b&&i("register",S,b.uid);const y=F(()=>k(k({},s),o(e))),{handleFullScreen:p,getWrapClassName:f,fullScreenRef:m}=st({modalWrapperRef:t,extHeightRef:u,wrapClassName:ze(y.value,"wrapClassName")}),v=F(()=>{const l=E(k({},o(y)),{open:o(a),okButtonProps:void 0,cancelButtonProps:void 0,title:void 0});return E(k({},l),{wrapClassName:o(f)})}),O=F(()=>{const l=E(k(k({},c),o(y)),{open:o(a)});return l.wrapClassName=`${(l==null?void 0:l.wrapClassName)||""} ${o(f)}vben-basic-modal-wrap`,o(m)?q(l,["height","title"]):q(l,"title")}),H=F(()=>{if(!o(m))return o(v).height});Y(()=>{a.value=!!s.open,m.value=!!s.defaultFullscreen}),pe(()=>o(a),l=>{i("open-change",l),i("update:open",l),b&&S.emitOpen&&S.emitOpen(l,b.uid),$(()=>{s.scrollTop&&l&&o(t)&&o(t).scrollTop()})},{immediate:!1});function C(l){return A(this,null,function*(){var X,w;if(l==null||l.stopPropagation(),!((w=(X=l.target)==null?void 0:X.classList)!=null&&w.contains(d+"-close--custom"))){if(s.closeFunc&&ge(s.closeFunc)){const j=yield s.closeFunc();a.value=!j;return}a.value=!1,i("cancel",l)}})}function W(l){e.value=Te(o(e)||{},l),Reflect.has(l,"open")&&(a.value=!!l.open),Reflect.has(l,"defaultFullscreen")&&(m.value=!!l.defaultFullscreen)}function x(l){i("ok",l)}function L(l){i("height-change",l)}function T(l){u.value=l}function P(l){s.canFullscreen&&(l.stopPropagation(),te(l))}function te(l){p(l),i("fullscreen")}return(l,X)=>(M(),D(o(Qe),I(O.value,{onCancel:C}),ae({default:h(()=>[B(ot,I({useWrapper:v.value.useWrapper,footerOffset:l.wrapperFooterOffset,fullScreen:o(m),ref_key:"modalWrapperRef",ref:t,loading:v.value.loading,"loading-tip":v.value.loadingTip,minHeight:v.value.minHeight,height:H.value,open:a.value,modalFooterHeight:l.footer!==void 0&&!l.footer?0:void 0},o(q)(v.value.wrapperProps,"open","height","modalFooterHeight"),{onExtHeight:T,onHeightChange:L}),{default:h(()=>[N(l.$slots,"default")]),_:3},16,["useWrapper","footerOffset","fullScreen","loading","loading-tip","minHeight","height","open","modalFooterHeight"])]),_:2},[l.$slots.closeIcon?void 0:{name:"closeIcon",fn:h(()=>[B(nt,{canFullscreen:v.value.canFullscreen,fullScreen:o(m),onCancel:C,onFullscreen:te},null,8,["canFullscreen","fullScreen"])]),key:"0"},l.$slots.title?void 0:{name:"title",fn:h(()=>[B(lt,{helpMessage:v.value.helpMessage,title:y.value.title,onDblclick:P},null,8,["helpMessage","title"])]),key:"1"},l.$slots.footer?void 0:{name:"footer",fn:h(()=>[B(at,I(O.value,{onOk:x,onCancel:C}),ae({_:2},[le(Object.keys(l.$slots),w=>({name:w,fn:h(j=>[N(l.$slots,w,se(re(j||{})))])}))]),1040)]),key:"2"},le(Object.keys(o(q)(l.$slots,"default")),w=>({name:w,fn:h(j=>[N(l.$slots,w,se(re(j||{})))])}))]),1040))}}),R=me({}),Z=me({});function mt(){const n=g(null),r=g(!1),s=g(0);function i(e,t){if(!Q())throw new Error("useModal() can only be used inside setup() or functional components!");s.value=t,fe(()=>{n.value=null,r.value=!1,R[String(o(s))]=null}),!(o(r)&&Pe()&&e===o(n))&&(n.value=e,r.value=!0,e.emitOpen=(d,u)=>{Z[u]=d})}const c=()=>{const e=o(n);return e||de("useModal instance is undefined!"),e},a={setModalProps:e=>{var t;(t=c())==null||t.setModalProps(e)},getOpen:F(()=>Z[~~o(s)]),redoModalHeight:()=>{var e,t;(t=(e=c())==null?void 0:e.redoModalHeight)==null||t.call(e)},openModal:(e=!0,t,d=!0)=>{var b;if((b=c())==null||b.setModalProps({open:e}),!t)return;const u=o(s);if(d){R[u]=null,R[u]=z(t);return}Je(z(R[u]),z(t))||(R[u]=z(t))},closeModal:()=>{var e;(e=c())==null||e.setModalProps({open:!1})}};return[i,a]}const gt=n=>{const r=g(null),s=Q(),i=g(0),c=()=>{const e=o(r);return e||de("useModalInner instance is undefined!"),e},a=(e,t)=>{$e(()=>{r.value=null}),i.value=t,r.value=e,s==null||s.emit("register",e,t)};return Y(()=>{const e=R[o(i)];e&&(!n||!ge(n)||$(()=>{n(e)}))}),[a,{changeLoading:(e=!0)=>{var t;(t=c())==null||t.setModalProps({loading:e})},getOpen:F(()=>Z[~~o(i)]),changeOkLoading:(e=!0)=>{var t;(t=c())==null||t.setModalProps({confirmLoading:e})},closeModal:()=>{var e;(e=c())==null||e.setModalProps({open:!1})},setModalProps:e=>{var t;(t=c())==null||t.setModalProps(e)},redoModalHeight:()=>{var t;const e=(t=c())==null?void 0:t.redoModalHeight;e&&e()}}]},ht=Ne(rt);export{ht as B,gt as a,ft as b,mt as u};
