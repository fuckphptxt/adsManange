var M=Object.defineProperty,v=Object.defineProperties;var F=Object.getOwnPropertyDescriptors;var g=Object.getOwnPropertySymbols;var A=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;var b=(o,t,e)=>t in o?M(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e,m=(o,t)=>{for(var e in t||(t={}))A.call(t,e)&&b(o,e,t[e]);if(g)for(var e of g(t))S.call(t,e)&&b(o,e,t[e]);return o},w=(o,t)=>v(o,F(t));var f=(o,t,e)=>new Promise((a,n)=>{var l=r=>{try{d(e.next(r))}catch(u){n(u)}},c=r=>{try{d(e.throw(r))}catch(u){n(u)}},d=r=>r.done?a(r.value):Promise.resolve(r.value).then(l,c);d((e=e.apply(o,t)).next())});import{a as q,B as R}from"./index-D4lH302q.js";import{_ as $}from"./BasicForm.vue_vue_type_script_setup_true_lang-C5My3wis.js";import"./BasicForm.vue_vue_type_style_index_0_lang-BvFAdDEs.js";import"./componentMap-ntVNUfGj.js";import{u as y}from"./useForm-Bpj89oTF.js";import{i as B,c as C,b as L}from"./system-DR9r84eU.js";import{d as D,f as I,u as i,c as N,Z as T,a8 as U,a9 as V,k as E,ac as O}from"./vue-BsEqlI2B.js";const G=(()=>{const o=["华东分部","华南分部","西北分部"],t=["研发部","市场部","商务部","财务部"];return o.reduce((e,a,n)=>(e[n]=a,t.forEach((l,c)=>e[`${n}-${c}`]=`${a}-${l}`),e),{})})(),Y=[{title:"用户名",dataIndex:"account",width:120},{title:"昵称",dataIndex:"nickname",width:120},{title:"邮箱",dataIndex:"email",width:120},{title:"创建时间",dataIndex:"createTime",width:180},{title:"角色",dataIndex:"role",width:200},{title:"所属部门",dataIndex:"dept",customRender:({value:o})=>G[o]},{title:"备注",dataIndex:"remark"}],ee=[{field:"account",label:"用户名",component:"Input",colProps:{span:8}},{field:"nickname",label:"昵称",component:"Input",colProps:{span:8}}],W=[{field:"account",label:"用户名",component:"Input",helpMessage:["本字段演示异步验证","不能输入带有admin的用户名"],rules:[{required:!0,message:"请输入用户名"},{trigger:"blur",validator(o,t){return new Promise((e,a)=>{if(!t)return e();B(t).then(e).catch(n=>{a(n.message||"验证失败")})})}}]},{field:"pwd",label:"密码",component:"InputPassword",required:!0,ifShow:!1},{label:"角色",field:"role",component:"ApiSelect",componentProps:{api:C,labelField:"roleName",valueField:"roleValue"},required:!0},{field:"dept",label:"所属部门",component:"TreeSelect",componentProps:{fieldNames:{label:"deptName",value:"id"},getPopupContainer:()=>document.body},required:!0},{field:"nickname",label:"昵称",component:"Input",required:!0},{label:"邮箱",field:"email",component:"Input",required:!0},{label:"备注",field:"remark",component:"InputTextArea"}],te=D({name:"AccountModal",__name:"AccountModal",emits:["success","register"],setup(o,{emit:t}){const e=t,a=I(!0),n=I(""),[l,{setFieldsValue:c,updateSchema:d,resetFields:r,validate:u}]=y({labelWidth:100,baseColProps:{span:24},schemas:W,showActionButtonGroup:!1,actionColOptions:{span:23}}),[_,{setModalProps:p,closeModal:P}]=q(s=>f(this,null,function*(){r(),p({confirmLoading:!1}),a.value=!!(s!=null&&s.isUpdate),i(a)&&(n.value=s.record.id,c(m({},s.record)));const h=yield L();d([{field:"pwd",show:!i(a)},{field:"dept",componentProps:{treeData:h}}])})),x=N(()=>i(a)?"编辑账号":"新增账号");function k(){return f(this,null,function*(){try{const s=yield u();p({confirmLoading:!0}),P(),e("success",{isUpdate:i(a),values:w(m({},s),{id:n.value})})}finally{p({confirmLoading:!1})}})}return(s,h)=>(T(),U(i(R),O(s.$attrs,{onRegister:i(_),title:x.value,onOk:k}),{default:V(()=>[E(i($),{onRegister:i(l)},null,8,["onRegister"])]),_:1},16,["onRegister","title"]))}});export{te as _,Y as c,ee as s};
