var U=Object.defineProperty;var D=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var T=(o,e,t)=>e in o?U(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,A=(o,e)=>{for(var t in e||(e={}))q.call(e,t)&&T(o,t,e[t]);if(D)for(var t of D(e))H.call(e,t)&&T(o,t,e[t]);return o};var g=(o,e,t)=>new Promise((p,d)=>{var y=i=>{try{u(t.next(i))}catch(f){d(f)}},k=i=>{try{u(t.throw(i))}catch(f){d(f)}},u=i=>i.done?p(i.value):Promise.resolve(i.value).then(y,k);u((t=t.apply(o,e)).next())});import{_ as K}from"./componentMap-ntVNUfGj.js";import"./entry/index-DeA-E56H-1712476170604.js";import"./helper-D26ItluK.js";import"./BasicForm.vue_vue_type_style_index_0_lang-BvFAdDEs.js";import{K as L}from"./antd-DeDWztM9.js";import{u as O}from"./index-D4lH302q.js";import"./TableImg.vue_vue_type_style_index_0_lang-D_jLqrrq.js";import"./uuid-D0SLUWHI.js";import"./sortable.esm-CoO8jRpa.js";import{P as $}from"./index-nsw1gsVQ.js";import{V as j}from"./index-BqTCX4sW.js";import{l as C,h as z}from"./system-DR9r84eU.js";import{_ as G}from"./updateModal.vue_vue_type_script_setup_true_lang-BXd-2QMz.js";import{d as W,f as n,r as Z,Z as _,a8 as J,a9 as c,k as h,u as m,ac as Q,_ as v,F as S,aa as B,G as E,a0 as F}from"./vue-BsEqlI2B.js";import"./useFormItem-C8SvMC7Y.js";import"./RadioButtonGroup.vue_vue_type_script_setup_true_lang-EGd22fob.js";import"./useSortable-B5C7L1iY.js";import"./download-C0dscIFQ.js";import"./base64Conver-bBv-IO2K.js";import"./index-CnUmmaWj.js";import"./IconPicker.vue_vue_type_script_setup_true_lang-BtQnCoXl.js";import"./copyTextToClipboard-CmW_HBj4.js";import"./index-eB2fGItq.js";import"./index-D77yVwLP.js";import"./useWindowSizeFn-dzDjg1EY.js";import"./onMountedOrActivated-DNS7E5S8.js";import"./useContentViewHeight-CYeOqeUw.js";const X=[{title:"ID",field:"id",width:50},{title:"角色名称",field:"name",width:180},{title:"权限",slots:{default:"routerList"}},{title:"包含用户",slots:{default:"allUser"}},{title:"创建时间",field:"create_time",width:150},{title:"操作",slots:{default:"action"},align:"center",width:200}],Y=[],tt=(o=[],e="id")=>{const t=[];return o.length<=0?[]:(o.forEach(p=>{t.push(p[e])}),t)},St=W({__name:"index",emits:["selectChangeEvent"],setup(o,{emit:e}){const[t,{openModal:p}]=O(),d=n(""),y=n("3");n(!1),n(!1);const k=n();n();const u=n([]),i=n(""),f=n(""),b=n([]),I=Z({id:"VxeTable",keepSource:!0,editConfig:{trigger:"click",mode:"cell",showStatus:!0},columns:X,toolbarConfig:{},formConfig:{enabled:!0,items:Y},height:"auto",proxyConfig:{ajax:{query:s=>g(this,[s],function*({page:a,form:r}){const l=yield C(A({page:a.currentPage,limit:a.pageSize,role_id:3},r));return{items:l.list,total:l.count}}),queryAll:r=>g(this,[r],function*({form:a}){return yield C(a)})}}}),M=a=>[{label:"分配用户",onClick:()=>{V(),d.value="分配用户",i.value=a.id;const s=[];a.user_list.map(w=>{s.push(w.id)}),b.value=s,setTimeout(()=>{p(!0)},300)}},{label:"编辑权限",onClick:()=>{}}],N=e,R=()=>g(this,null,function*(){var r;const a=yield C({role_id:y.value});(r=k.value)==null||r.reloadData(a.list)}),V=()=>g(this,null,function*(){const a=yield z({role_id:""});u.value=P(a.list)}),x=a=>{const r=tt(a.records);N("selectChangeEvent",r)},P=a=>{const r=[];return a.map(s=>{r.push({key:s.id,title:s.username})}),r};return(a,r)=>(_(),J(m($),{contentFullHeight:"",fixedHeight:"",contentBackground:""},{default:c(()=>[h(m(j),Q({ref_key:"tableRef",ref:k},I,{onCheckboxChange:x,onCheckboxAll:x}),{toolbalSlot:c(()=>[]),action:c(({row:s})=>[h(m(K),{outside:"",actions:M(s)},null,8,["actions"])]),routerList:c(({row:s})=>[(_(!0),v(S,null,B(s.route,l=>(_(),v("span",{key:l},[h(m(L),null,{default:c(()=>[E(F(l),1)]),_:2},1024)]))),128))]),allUser:c(({row:s})=>[(_(!0),v(S,null,B(s.user_list,l=>(_(),v("span",{key:l},[h(m(L),{color:"purple"},{default:c(()=>[E(F(l.username),1)]),_:2},1024)]))),128))]),_:1},16),h(G,{password:i.value,title:d.value,onOkFunction:R,onRegister:m(t),mockData:u.value,originalName:f.value,targetId:b.value},null,8,["password","title","onRegister","mockData","originalName","targetId"])]),_:1}))}});export{St as default};
