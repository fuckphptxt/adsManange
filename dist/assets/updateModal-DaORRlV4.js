var R=(n,C,d)=>new Promise((m,y)=>{var k=r=>{try{h(d.next(r))}catch(e){y(e)}},o=r=>{try{h(d.throw(r))}catch(e){y(e)}},h=r=>r.done?m(r.value):Promise.resolve(r.value).then(k,o);h((d=d.apply(n,C)).next())});import{a as K,B as T}from"./index-D4lH302q.js";import{u as q,_ as E}from"./entry/index-DeA-E56H-1712476170604.js";import{j as F,k as Y,l as Z,h as z}from"./system-DR9r84eU.js";import{d as G,f as i,I as H,r as J,h as Q,a7 as W,Z as c,a8 as p,a9 as u,$ as S,u as a,k as v,ab as g,ac as X,a2 as ee,a3 as ae}from"./vue-BsEqlI2B.js";import{Y as w,V as U,am as te}from"./antd-DeDWztM9.js";import"./useWindowSizeFn-dzDjg1EY.js";const se=n=>(ee("data-v-3fb0867f"),n=n(),ae(),n),oe=["model"],le=se(()=>S("span",null,"暂无数据",-1)),ne=G({__name:"updateModal",props:{title:{type:String,defualt:"修改密码"},password:{type:String,default:"00:00:00"},targetId:{type:Array,default:()=>["4"]},mockData:{type:Array,default:()=>[]}},emits:["okFunction"],setup(n,{emit:C}){const d=n,m=i([]),y=i(),k=i(),{password:o,mockData:h,targetId:r}=H(d),e=J({password:"",newPassword:"",account:"",role:"",manager_id:""}),V={password:[{required:!0,message:"请输入密码",trigger:"change",type:"object"}]},D=i(),x=i(),{createMessage:_}=q(),P=i(!1),B=i({}),I=C,[$,{closeModal:M,changeOkLoading:f}]=K(l=>{l&&N(l)}),L=(l,t,b)=>{m.value=l};function N(l){B.value={selectValue:l.selectValue}}const O=()=>R(this,null,function*(){f(!0),setTimeout(()=>{f(!1)},2e3),e.password&&o.value?(yield F({new_password:e.newPassword,id:o.value,type:o.value?"update":"add",username:e.account,password:e.password,role_id:e.role}),e.password="",_.success("提交成功！"),I("okFunction"),f(!1),M()):e.account&&e.password&&e.role?(yield F({type:"add",username:e.account,password:e.password,role_id:e.role,manager_id:D.value!="经理"?e.manager_id:null}),e.account="",e.password="",e.role="",e.manager_id="",_.success("提交成功！"),I("okFunction"),f(!1),M()):_.info("存在必填选项未填写"),d.title==="编辑经理"&&(yield Y({manager_id:o.value,ids:m.value}),_.success("提交成功！"),I("okFunction"),f(!1),M()),f(!1)}),j=()=>{e.password=""};R(this,null,function*(){const l=yield Z(),t=yield z({role_id:"2"});y.value=l.list,k.value=t.list});const A=(l,t)=>{D.value=t.name};return Q(()=>{m.value=r.value}),(l,t)=>{const b=W("a-input");return c(),p(a(T),X(l.$attrs,{onRegister:a($),title:n.title,visible:P.value,width:"730px",onOk:O,onVisibleChange:j}),{default:u(()=>[S("div",null,[S("form",{ref_key:"formRef",ref:x,model:e,rules:V,"label-col":{span:4},"wrapper-col":{span:14}},[a(o)&&n.title!="编辑经理"?(c(),p(a(w),{key:0,label:"重置密码"},{default:u(()=>[v(b,{value:e.newPassword,"onUpdate:value":t[0]||(t[0]=s=>e.newPassword=s),placeholder:"请输入密码"},null,8,["value"])]),_:1})):g("",!0),a(o)?g("",!0):(c(),p(a(w),{key:1,label:"用户账号"},{default:u(()=>[v(b,{value:e.account,"onUpdate:value":t[1]||(t[1]=s=>e.account=s),placeholder:"请输入账号"},null,8,["value"])]),_:1})),a(o)?g("",!0):(c(),p(a(w),{key:2,label:"账号密码"},{default:u(()=>[v(b,{value:e.password,"onUpdate:value":t[2]||(t[2]=s=>e.password=s),placeholder:"请输入密码"},null,8,["value"])]),_:1})),a(o)?g("",!0):(c(),p(a(w),{key:3,label:"所属角色"},{default:u(()=>[v(a(U),{value:e.role,"onUpdate:value":t[3]||(t[3]=s=>e.role=s),"show-search":"",placeholder:"请选择角色","field-names":{label:"name",value:"id"},options:y.value,onChange:A},null,8,["value","options"])]),_:1})),D.value!="经理"&&!a(o)?(c(),p(a(w),{key:4,label:"所属经理"},{default:u(()=>[v(a(U),{value:e.manager_id,"onUpdate:value":t[4]||(t[4]=s=>e.manager_id=s),"show-search":"",placeholder:"请选择经理","field-names":{label:"username",value:"id"},options:k.value},null,8,["value","options"])]),_:1})):g("",!0),n.title==="编辑经理"?(c(),p(a(w),{key:5,label:"编辑经理"},{default:u(()=>[v(a(te),{"data-source":a(h),"show-search":"","list-style":{width:"280px",height:"300px"},titles:["可选择用户","已选择用户"],operations:["移入",""],"target-keys":m.value,render:s=>`${s.key}-${s.title}【原经理：${s.name}】`,onChange:L},{notFoundContent:u(()=>[le]),_:1},8,["data-source","target-keys","render"])]),_:1})):g("",!0)],8,oe)])]),_:1},16,["onRegister","title","visible"])}}}),ve=E(ne,[["__scopeId","data-v-3fb0867f"]]);export{ve as default};
