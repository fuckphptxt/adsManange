var x=(c,b,d)=>new Promise((g,y)=>{var m=l=>{try{V(d.next(l))}catch(e){y(e)}},t=l=>{try{V(d.throw(l))}catch(e){y(e)}},V=l=>l.done?g(l.value):Promise.resolve(l.value).then(m,t);V((d=d.apply(c,b)).next())});import{a as G,B as P}from"./index-D4lH302q.js";import{u as $}from"./entry/index-DeA-E56H-1712476170604.js";import{h as j,f as A,g as z}from"./work-DhQ6FW9u.js";import{Y as _,V as J,ae as Y,aJ as Z,aI as K,aa as C}from"./antd-DeDWztM9.js";import{d as Q,r as U,I as X,f as h,h as ee,a7 as ae,Z as f,a8 as v,a9 as o,$ as F,u as a,k as n,ab as k,ag as N,G as B,ac as te}from"./vue-BsEqlI2B.js";const le=["model"],me=Q({__name:"add-modal",props:{title:{type:String},time:{type:String,default:""},timeValue:{type:String,default:""},accid:{type:String||Number,default:""},flow_id:{type:String,default:""},handle_type:{type:String||Number,default:""}},emits:["okFunction","okModal"],setup(c,{emit:b}){const d=c,g=U({height:"30px",lineHeight:"30px"}),{time:y,accid:m,handle_type:t,timeValue:V,flow_id:l}=X(d),e=U({timeValue:"",selectValue:"",time:"",isExp:1}),E={timeValue:[{required:!0,message:"请选择时间",trigger:"change",type:"object"}],selectValue:[{required:!0,message:"请选择",trigger:"change"}],time:[{required:!0,message:"请选择",trigger:"change"}]},R=h([]),I=h(),{createMessage:p}=$(),O=h(!1),L=h({}),w=b,[T,{closeModal:S,changeOkLoading:i}]=G(s=>{s&&q(s)}),M=s=>{};function q(s){L.value={selectValue:s.selectValue}}const D=()=>x(this,null,function*(){i(!0),setTimeout(()=>{i(!1)},2e3),e.timeValue&&t.value!="procedureAdd"?(yield j({handle_type:t.value,name:e.timeValue,id:m.value}),p.success("提交成功！"),w("okFunction"),i(!1),S()):t.value=="procedureAdd"?e.selectValue&&e.time?(yield A({handle_type:t.value=="procedureAdd"?"add":"update",type_id:m.value,interval:e.time,flow_id:m.value,ignore_fail:e.isExp}),p.success("保存成功！"),w("okModal"),i(!1),S()):(p.error("请选择任务类型和时间间隔"),i(!1)):t.value=="procedureUpdate"&&(e.time?(yield A({handle_type:"update",id:m.value,interval:e.time,flow_id:l.value}),p.success("保存成功！"),w("okModal"),i(!1),S()):(p.error("请选择时间间隔"),i(!1))),i(!1)}),H=()=>{e.timeValue=""};return x(this,null,function*(){const s=yield z();R.value=s}),ee(()=>{e.time=y.value}),(s,r)=>{const W=ae("a-input");return f(),v(a(P),te(s.$attrs,{onRegister:a(T),title:c.title,visible:O.value,onOk:D,onVisibleChange:H}),{default:o(()=>[F("div",null,[F("form",{ref_key:"formRef",ref:I,model:e,rules:E,"label-col":{span:4},"wrapper-col":{span:14}},[a(t)=="procedureAdd"?(f(),v(a(_),{key:0,label:"选择任务类型",name:"selectValue"},{default:o(()=>[n(a(J),{value:e.selectValue,"onUpdate:value":r[0]||(r[0]=u=>e.selectValue=u),"show-search":"",placeholder:"请选择","field-names":{label:"name",value:"id"},options:R.value},null,8,["value","options"])]),_:1})):k("",!0),a(t)=="procedureAdd"||a(t)=="procedureUpdate"?(f(),v(a(_),{key:1,label:"选择时间间隔",name:"time"},{default:o(()=>[n(a(Y),{style:{width:"100%"},value:e.time,"onUpdate:value":r[1]||(r[1]=u=>e.time=u),valueFormat:"HH:mm:ss",onChange:M},{suffixIcon:o(()=>[n(a(Z))]),_:1},8,["value"])]),_:1})):k("",!0),a(t)=="procedureAdd"?(f(),v(a(_),{key:2,label:"执行错误时顺延",name:"selectValue"},{default:o(()=>[n(a(K),{value:e.isExp,"onUpdate:value":r[2]||(r[2]=u=>e.isExp=u)},{default:o(()=>[n(a(C),{style:N(g),value:1},{default:o(()=>[B("是")]),_:1},8,["style"]),n(a(C),{style:N(g),value:0},{default:o(()=>[B("否")]),_:1},8,["style"])]),_:1},8,["value"])]),_:1})):k("",!0),a(t)!="procedureAdd"&&a(t)!="procedureUpdate"?(f(),v(a(_),{key:3,label:c.title,name:"timeValue"},{default:o(()=>[n(W,{value:e.timeValue,"onUpdate:value":r[3]||(r[3]=u=>e.timeValue=u),placeholder:"请输入",onChange:M},null,8,["value"])]),_:1},8,["label"])):k("",!0)],8,le)])]),_:1},16,["onRegister","title","visible"])}}});export{me as _};
