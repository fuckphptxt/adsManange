var c=(n,p,a)=>new Promise((r,i)=>{var d=t=>{try{o(a.next(t))}catch(s){i(s)}},m=t=>{try{o(a.throw(t))}catch(s){i(s)}},o=t=>t.done?r(t.value):Promise.resolve(t.value).then(d,m);o((a=a.apply(n,p)).next())});import{a as L,B as D}from"./index-D4lH302q.js";import{u as T}from"./entry/index-DeA-E56H-1712476170604.js";import{_ as W}from"./BasicForm.vue_vue_type_script_setup_true_lang-C5My3wis.js";import"./BasicForm.vue_vue_type_style_index_0_lang-BvFAdDEs.js";import"./componentMap-ntVNUfGj.js";import{u as q}from"./useForm-Bpj89oTF.js";import{s as x,g as A,b as N}from"./select-gA0uFJlM.js";import{d as $,f as y,I as j,o as G,Z,a8 as z,a9 as E,$ as H,k as J,u,ac as K}from"./vue-BsEqlI2B.js";const le=$({__name:"add-modal",props:{userData:{type:Object},title:{type:String},ifShow:{type:Boolean,default:!1},handleType:{type:String,default:""},accid:{type:String||Number,default:""},recordsIdList:{type:Array,default:()=>[]},required:{type:Boolean,default:!1}},emits:["okFunction"],setup(n,{emit:p}){const a=[],r=[],{createMessage:i}=T(),d=y(!1),m=n,{ifShow:o,handleType:t,recordsIdList:s,accid:g,required:h}=j(m),_=[{field:"accId",component:"Input",label:"acc ID",colProps:{span:24},show:()=>!o.value,defaultValue:"",required:()=>h.value},{field:"selectValue",component:"Select",label:"下一步执行任务",colProps:{span:24},show:()=>!o.value,required:()=>h.value,componentProps:{options:r,placeholder:"请选择",showSearch:!0,allowClear:!0,optionFilterProp:"label"}},{field:"selectValue",component:"Select",label:"设置标签",colProps:{span:24},show:()=>o.value,componentProps:{options:a,placeholder:"请选择标签",mode:"tags",showSearch:!0,allowClear:!0,optionFilterProp:"label"}}],b=y({}),F=p,[V,{validate:k,setProps:v,getFieldsValue:B,resetFields:S}]=q({labelWidth:80,schemas:_,showActionButtonGroup:!1,actionColOptions:{span:24},submitButtonOptions:{text:"提交"}}),[P,{closeModal:C,changeOkLoading:f}]=L(e=>{e&&I(e)});function I(e){b.value={selectValue:e.selectValue}}const O=()=>c(this,null,function*(){f(!0);try{yield k(),v({submitButtonOptions:{loading:!0}});const e=B();v({submitButtonOptions:{loading:!1}});const w=yield x({handle_type:t.value,acc_id_list:g.value?g.value:s.value,step_id:e.selectValue,tag_list:e==null?void 0:e.selectValue});i.success("提交成功！"),F("okFunction"),f(!1),S(),C()}catch(e){f(!1)}}),R=e=>{};return G(()=>{const e=()=>c(this,null,function*(){(yield A()).map(l=>{a.push({value:l.name,label:l.name})})});c(this,null,function*(){(yield N()).map(l=>{r.push({value:l.id,label:l.type_name})})}),e()}),(e,w)=>(Z(),z(u(D),K(e.$attrs,{onRegister:u(P),title:n.title,visible:d.value,onVisibleChange:R,onOk:O}),{default:E(()=>[H("div",null,[J(u(W),{onRegister:u(V),model:b.value},null,8,["onRegister","model"])])]),_:1},16,["onRegister","title","visible"]))}});export{le as _};
