var k=(v,m,r)=>new Promise((l,p)=>{var o=n=>{try{i(r.next(n))}catch(u){p(u)}},g=n=>{try{i(r.throw(n))}catch(u){p(u)}},i=n=>n.done?l(n.value):Promise.resolve(n.value).then(o,g);i((r=r.apply(v,m)).next())});import{d as U,f as w,r as z,c as E,u as e,Z as N,_ as T,m as F,A as b,k as s,a9 as t,G as C,a0 as L,al as $,F as A}from"./vue-BsEqlI2B.js";import{u as V,a as G,b as K,L as P,_ as q}from"./LoginFormTitle.vue_vue_type_script_setup_true_lang-DrpwO4kP.js";import{i as O,h as Z,m as j,u as H}from"./entry/index-DeA-E56H-1712476170604.js";import{a0 as I,y as R,a1 as J,B as Q,U as W,R as X}from"./antd-DeDWztM9.js";const ne=U({__name:"LoginForm",setup(v){const m=W,r=X,l=I.Item,p=R.Password,{t:o}=O(),{notification:g,createErrorModal:i}=H(),{prefixCls:n}=Z("login"),u=j(),{setLoginState:Y,getLoginState:B}=V(),{getFormRules:D}=G(),_=w(),y=w(!1),x=w(!1),c=z({account:"",password:""}),{validForm:M}=K(_),h=E(()=>e(B)===P.LOGIN);function S(){return k(this,null,function*(){const f=yield M();if(f)try{y.value=!0;const a=yield u.login({password:f.password,username:f.account,mode:"none"});a&&g.success({message:o("sys.login.loginSuccessTitle"),description:`${o("sys.login.loginSuccessDesc")}: ${a.username}`,duration:3})}catch(a){i({title:o("sys.api.errorTip"),content:a.message||o("sys.api.networkExceptionMsg"),getContainer:()=>document.body.querySelector(`.${n}`)||document.body})}finally{y.value=!1}})}return(f,a)=>(N(),T(A,null,[F(s(q,{class:"enter-x"},null,512),[[b,h.value]]),F(s(e(I),{class:"p-4 enter-x",model:c,rules:e(D),ref_key:"formRef",ref:_,onKeypress:$(S,["enter"])},{default:t(()=>[s(e(l),{name:"account",class:"enter-x"},{default:t(()=>[s(e(R),{size:"large",value:c.account,"onUpdate:value":a[0]||(a[0]=d=>c.account=d),placeholder:e(o)("sys.login.userName"),class:"fix-auto-fill"},null,8,["value","placeholder"])]),_:1}),s(e(l),{name:"password",class:"enter-x"},{default:t(()=>[s(e(p),{size:"large",visibilityToggle:"",value:c.password,"onUpdate:value":a[1]||(a[1]=d=>c.password=d),placeholder:e(o)("sys.login.password")},null,8,["value","placeholder"])]),_:1}),s(e(r),{class:"enter-x"},{default:t(()=>[s(e(m),{span:12},{default:t(()=>[s(e(l),null,{default:t(()=>[s(e(J),{checked:x.value,"onUpdate:checked":a[2]||(a[2]=d=>x.value=d),size:"small"},{default:t(()=>[C(L(e(o)("sys.login.rememberMe")),1)]),_:1},8,["checked"])]),_:1})]),_:1}),s(e(m),{span:12},{default:t(()=>[s(e(l),{style:{"text-align":"right"}})]),_:1})]),_:1}),s(e(l),{class:"enter-x"},{default:t(()=>[s(e(Q),{type:"primary",size:"large",block:"",onClick:S,loading:y.value},{default:t(()=>[C(L(e(o)("sys.login.loginButton")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"]),[[b,h.value]])],64))}});export{ne as _};
